## プロダクト概要

『お天気おかん』は、毎朝の天気予報を「お母さん」のような口調でユーザーに伝えるモバイルアプリです。ハッカソンの提出物として、必要最小限の機能を盛り込んだMVPとして高速に構築します。

## 用語定義
- 「お天気おかん」：アプリ日本語表示名
- 「weathermother」：ローカル開発時に使用するプロジェクト名
- 「お母さん天気情報」：APIで取得した天気予報情報をLLMで「まるでお母さんが言っているようなセリフ」に変換されたもの
- 

## 実装済みの部分
現在、すでに「バックエンド」部分は完璧に実装が完了しています。
なので今回は、フロントエンド部分、モバイルアプリ部分の開発に注力します。

## 技術概要
### バックエンド
バックエンドでは、以下の処理をバッチで毎日6時に行います。
「天気予報APIから取得した天気情報をGeminiに渡して、お母さん言葉に変換したものをfirestoreに保存」
### フロントエンド
フロントエンドでは、LLMとの通信などは一切行わず、firestoreに格納されている「お母さん天気情報」を表示するシンプルな機能にします。

#### 技術選定
##### バックエンド
- **Cloud Functions:** 天気予報APIから天気情報の取得、「お母さん天気情報」の生成、firestoreへの保存。
- **Vertex AI Studio (Gemini API):** 天気予報データを「おかあさんがいった」風のメッセージ（「お母さん天気情報」）に変換。
- **Cloud Scheduler:** Cloud Functions を定期的に実行するためのスケジューリングサービス。
- **Firestore:** NoSQL データベース。ユーザー情報（都道府県、プッシュ通知希望時間）、「お母さん天気情報」を保存します。
##### フロントエンド
- Expo（ReactNative）

## 開発フロー
1. 環境構築
2. 簡易的な画面設計
3. Firebase Authによる匿名ユーザー認証機能実装
4. UIの作成と基本的な画面遷移の実装
5. ユーザーが都道府県を設定して、設定内容を保存する
6. Firestoreのデータを参照して表示する
7. プッシュ通知機能の実装
8. デバッグ
9. リリース準備


## 機能概要(フロントエンド)
### 「お母さん天気情報」表示機能
ユーザーがあらかじめ選択した都道府県と対応する「お母さん天気情報」を **毎日6時以降にアクセスした際に** Firestoreから取得して表示する。
### ユーザー認証機能
・Firebase Authentication を使用して匿名認証を実装。
・ユーザーはアプリ起動時に自動的に匿名ユーザーとしてログインする。
### 都道府県設定機能
・初回起動時に、ユーザーに都道府県を選択させる。  
・選択された都道府県は、ユーザー情報として Firestore に保存される。
### プッシュ通知
・毎日指定した時刻（例：7:00）に、ユーザーの都道府県に対応する「お母さん天気情報」メッセージをプッシュ通知で送信する。
## 画面構成
1. **起動画面（スプラッシュスクリーン）**
    - アプリのアイコンと名前
    - 読み込み中のインジケーター (オプション)
2. **初期設定画面（初回起動時のみ）**
    - 「お天気おかん」の簡単な説明
    - 都道府県選択用のドロップダウンリスト
    - 「はじめる」ボタン （この後にプッシュ通知の許諾を求める）
3. **メイン画面**
    - 「お母さん天気情報」の表示
    - おかんのイラスト素材
    - 歯車アイコン：明日とサイドメニューが開く。サイドメニューには、利用規約とプライバシーポリシーへのリンク、クレジットの表記（将来的にはアプリ内設定を行えるようにする）

## データベース構造
FirestoreをDBとして使用
### 天気情報関連
以下の形でデータが格納済み。
```
weather_data/ // コレクション名
  └── YYYYMMDD-areaCode/ // ドキュメントID（例：20240315-130000）
       ├── area_code: string      // 地域コード（例：130000）
       ├── weather_forecasts: string  // 気象庁APIからの天気予報データ（JSON文字列）
       ├── generated_message: string   // Geminiが生成したお母さんのメッセージ
       └── createdat: timestamp    // データ作成日時
```
### ユーザー情報関連
以下の形でのデータ格納を想定しています。
```
users/ // コレクション名
  └── ユーザー ID (Firebase Authentication で生成される UID)/ // ドキュメントID
       ├── user_id: string      // 地域コード（例：130000）
       ├── prefecture: string  // ユーザーが選択した都道府県 (例: `tokyo`, `ehime`)
       ├── preferredPushNotificationTime: string   // ユーザーが設定したプッシュ通知希望時刻 (例: `07:00`) (オプション機能。MVPでは使用しないが、将来のために定義しておく)
       └── createdat: timestamp    // ユーザー情報作成日時
```
**サンプルデータ**
```json
{
  "userId": "abcdefg1234567890",
  "prefecture": "tokyo",
  "preferredPushNotificationTime": "07:00",
  "createdAt": "2023-10-27T09:00:00Z"
}
```


## プロンプト
```
あなたに渡したのはたった今取得した特定地域の天気予報情報です。

この天気予報の情報を一般家庭のお母さんが朝のテレビで知ったとします。

その後、家を出かけようとした女子高生の娘に対して、今日の天気に関して話すだろうセリフを、指定するjson形式で出力してください。

  

# セリフ条件

- セリフは一つだけにしてください。

- 必要以上に天気情報を網羅しようとしなくて構いません。その人物が重要だと思って娘に話すだろうセリフを出力してください。

- お母さんは50代の女性です。その地域の方言が強い場合は、方言を軽く取り入れたセリフにしてください。

- 指定したjson形式以外の文字列は出力しないでください。

  

# 出力条件

- 余分な説明や装飾は一切付けず、セリフのみを出力してください。

  

# 出力例:

{

"mother_message": "今日の夜雨が降るかもしれんから、折り畳み傘もっときー。あと、夜寒いかもしれんから上着とか羽織っていきなね。"

}
```
